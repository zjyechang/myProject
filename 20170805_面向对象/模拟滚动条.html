<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <style type="text/css">
            *{
                padding:0;
                margin:0;
            }
            .box{
                width: 800px;
                height: 400px;
                border:1px solid red;
                margin:50px auto;
                position:relative;
                overflow: hidden;
            }
            .box .content{
                position:absolute;
                width: 740px;
                top:0;
                left:0;
                line-height: 150%;
                font-size: 14px;
                padding:20px;
            }
            .box .content p{
                margin-bottom: 20px;
            }
            .box .bar{
                position:absolute;
                top:0;
                right: 0;
                width: 20px;
                height: 400px;
                background-color: #ccc;
            }
            .box .bar b{
                position:absolute;
                width: 20px;
                height: 34px;
                background-color: orange;
            }
        </style>
    </head>
    <body>
        <div class="box" id="box">
            <div class="bar" id="bar">
                <b id="barB"></b>
            </div>
            <div class="content" id="content">
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>

                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>

                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p><p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>

                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
                <p>多家海滨浴场现“人狗同浴” 浴场：无权禁止狗入内</p>
            </div>
        </div>


        <script type="text/javascript">
            //得到元素
            var box = document.getElementById("box");
            var content = document.getElementById("content");
            var barB = document.getElementById("barB");

            //内容-盒子高度比
            var rate = box.clientHeight / content.clientHeight;
                        // 400 /  1000   =0.4
                        // 400 / 200 = 2
                // 比例的三元判断
                rate = rate>1 ? 1 : rate;

            //设置一个滑块的初始高度
            barB.style.height = box.clientHeight * rate +"px";

            // 信号量，滑块的top值
            var newBarBTop = 0;

            // 信号量，内容的top值
            var newContentTop = 0;



            //拖拽
            barB.onmousedown=function(event){
                event = event || window.event;

                //计算增量 offsetTop
                var disY = event.clientY - barB.offsetTop;


                document.onmousemove=function(event){
                    event = event || window.event;

                    // 新的y值
                    newBarBTop = event.clientY - disY;

                    //范围
                    if( newBarBTop < 0 ) newBarBTop = 0;
                    if( newBarBTop > box.clientHeight - barB.clientHeight){
                        newBarBTop = box.clientHeight - barB.clientHeight;
                    }

                    barB.style.top = newBarBTop + "px";

                    //内容按比例升高，内容跑的比滑块b标签块，内容走1px/rate
                     newContentTop = -newBarBTop/rate;
                    content.style.top = newContentTop +"px";

                    //给这个事件返回一个false，就不能圈选文字了
                    return false;

                }
                document.onmouseup=function(){
                    document.onmousemove=null;
                }
            }


            function mousewheelhandler(event){
                event = event || window.event;

                //阻止默认事件
                if(event.preventDefault){
                    event.preventDefault();
                }else{
                    event.returnValue = false;
                }

                //Chrome，IE用的是event.wheelDelta
                if( event.wheelDelta ){
                    var direction = event.wheelDelta > 0 ? 1 : -1;

                // 三元运算符 判断鼠标滚轮如果是
                // 往上滚动 120  1  往下滚动 -120 -1
                }else{
                    //火狐用的是event.detail
                    var direction = event.detail > 0 ? -1 : 1;

                    // 三元运算符 判断鼠标滚轮如果是
                // 往上滚动 -3  1  往下滚动 3 -1
                }


                //带着barB跑，当我们鼠标滚轮往下滚的时候，此时direction -1；
                //我们期待内容往上跑，滑块往下滚
                newBarBTop += -20 * direction;

                // 范围
                if( newBarBTop < 0 ) newBarBTop = 0;
                if( newBarBTop > box.clientHeight- barB.clientHeight) newBarBTop = box.clientHeight- barB.clientHeight

                // 内容的信号量，滑块的移动方向和内容是反着的
                newContentTop = -newBarBTop / rate;
                // console.log( newBarBTop + ","+ rate);
                // console.log( newContentTop );

                // 运动
                barB.style.top = newBarBTop + "px";
                content.style.top = newContentTop + "px";

            }

            // 这里不用根据不同浏览器进行判断，这是因为事件添加了如果浏览器不认识，不报错
            // 给Chrome IE添加事件
            box.onmousewheel = mousewheelhandler;

            try{
                box.addEventListener("DOMMouseScroll", mousewheelhandler, false);
            }catch(err){

            }

        </script>
    </body>
</html>