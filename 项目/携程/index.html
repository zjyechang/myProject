<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>携程旅行</title>
    <link rel="stylesheet" href="./css/style.css">
</head>
<body>
    <header>
        <div class="soso">
            <div class="soso_box">
                <input type="text" placeholder="目的地/酒店/景点/航班号" name="search">
            </div>
        </div>
        <div class="user">
            <a href="#">我 的</a>
        </div>

    </header>
    <!-- banner -->
    <section class="banner">

            <div class="imglist">
                <ul>
                    <li><a href="#"><img src="./images/2.jpg" alt=""></a></li>
                    <li><a href="#"><img src="./images/3.jpg" alt=""></a></li>
                    <li><a href="#"><img src="./images/4.jpg" alt=""></a></li>
                    <li><a href="#"><img src="./images/5.jpg" alt=""></a></li>
                    <li><a href="#"><img src="./images/6.jpg" alt=""></a></li>
                </ul>
            </div>
            
            <div class="cir">
                <ol>
                    <li class="cur"></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                </ol>
            </div>

    </section>
    <!-- 导航部分 -->
    <nav>
        <div class="row">
            <ul>
                <li>
                    <div><a href="#">酒 店</a></div>
                </li>
                <li>
                    <div><a href="#">海外酒店</a></div>
                </li>
                <li>
                    <div><a href="#">团 购</a></div>
                </li>
                <li>
                    <div><a href="#">特价酒店</a></div>
                </li>
                <li>
                    <div><a href="#">民宿·客栈</a></div>
                </li>
            </ul>
        </div>

        <div class="row">
            <ul>
                <li>
                    <div><a href="#">机 票</a></div>
                </li>
                <li>
                    <div><a href="#">火车票·抢票</a></div>
                </li>
                <li>
                    <div><a href="#">汽车票·船票</a></div>
                </li>
                <li>
                    <div><a href="#">特价机票</a></div>
                </li>
                <li>
                    <div><a href="#">专车·租车</a></div>
                </li>
            </ul>
        </div>

        <div class="row">
            <ul>
                <li>
                    <div><a href="#">旅 游</a></div>
                </li>
                <li>
                    <div><a href="#">目的地攻略</a></div>
                </li>
                <li>
                    <div><a href="#">邮轮旅行</a></div>
                </li>
                <li>
                    <div><a href="#">周边游</a></div>
                </li>
                <li>
                    <div><a href="#">定制旅游</a></div>
                </li>
            </ul>
        </div>

    <div class="row">
            <ul>
                <li>
                    <div><a href="#">景点·玩乐</a></div>
                </li>
                <li>
                    <div><a href="#">美食林</a></div>
                </li>
                <li>
                    <div><a href="#">购物·信用卡</a></div>
                </li>
                <li>
                    <div><a href="#">礼品卡</a></div>
                </li>
                <li>
                    <div><a href="#">WIFI·电话卡</a></div>
                </li>
                <li>
                    <div><a href="#">保险·签证</a></div>
                </li>
            </ul>
        </div>
    </nav>

    <section class="sunNav">
        <ul class="row1">
            <li><a href="#">自由行</a></li>
            <li><a href="#">微领队</a></li>
            <li><a href="#">一日游</a></li>
            <li><a href="#">高端游</a></li>
        </ul><ul class="row2">
            <li><a href="#">酒店+景点</a></li>
            <li><a href="#">海外玩乐</a></li>
            <li><a href="#">外币兑换</a></li>
            <li><a href="#">加盟合作</a></li>
        </ul><ul class="row3">
            <li><a href="#">机场停车</a></li>
            <li><a href="#">行李寄送</a></li>
            <li><a href="#">当季去哪</a></li>
            <li><a href="#">更多服务</a></li>   
        </ul>
    </section>
    
    <section class="sale-wrap">
            <h2>特卖汇
                <a href="#" class="title-button">领红包再下单></a>
            </h2>

            <div class="sale-box">
                <div class="sale-img">
                    <span class="sale-hot">爆款</span>
                    <img src="./images/1.jpg" alt="">
                </div>
                <p class="sale-title">长滩岛5日4晚自由行·★秒杀甩尾  指定高尔夫酒店 赠接送机</p>
                <div class="sell-info">
                    <span class="sell-price">￥1900起</span>
                    <span class="sell-tag">省￥1500</span>
                </div>
            </div>
            <div class="sale-list">
                <div class="sale-txt">
                        <dt>千款特价</dt>
                        <dd>走过路过不错过</dd>
                </div>
                <img src="./images/pic-tmh-02.png" alt="">
            </div>

            <div class="sale-list item">
                <div class="sale-txt">
                        <dt>海外精选</dt>
                        <dd><span>百元</span>出境游</dd>
                </div>
                <img src="./images/pic-tmh-04.png" alt="">
            </div>

            <div class="sale-list item">
                <div class="sale-txt">
                        <dt>周边玩乐</dt>
                        <dd><span>十元</span>度周末</dd>
                </div>
                <img src="./images/pic-tmh-03.png" alt="">
            </div>
    </section>

    <section class="active-wrap">
        <h2>热门活动
            <a href="#" class="title-button">获取更多福利></a>
            <img src="./images/icon-gg@2x.png" alt="">
        </h2>

        <div class="sale-imgs">
            <img src="./images/AD02-cs320.jpg" alt="">
            <img src="./images/AD03-fbdyj320.jpg" alt="">
            <img src="./images/app_home_ad03_js320160.png" alt="">
            <img src="./images/320160.jpg" alt="">
            <img src="./images/AD03-qd320.jpg" alt="">
            
        </div>
    </section>
    <section class="tool-box">
        <a href="#">电话预定</a>
        <a href="#">下载客户端</a>
        <a href="#">我 的</a>        
    </section>

    <footer>
        <div class="tool-ver">
            <a href="#">网站地图</a> |
            <a href="#">Global sites</a> |
            <a href="#">电脑版</a>
        </div>
        <p>&copy;2017携程旅行 | 沪ICP备08023580号</p>
    </footer>



    <script>

        var carousel = document.querySelector(".banner");
        var imageLis = document.querySelectorAll(".banner ul li");
        var olLis = document.querySelectorAll("ol li");

        var idx= 0;
        var next = 1;
        var prev = 4;

        init();
        window.onresize = init;

        function init(){
            // console.log(document.body.style.width);
            // 得到屏幕宽
            windowWidth = document.documentElement.clientWidth;
            if(windowWidth>540) windowWidth =540;
            if(windowWidth<320) windowWidth =320;
            // 设置盒子高度
            carousel.style.height = windowWidth/ (768/154)+"px";
            

            for(var i=0;i<imageLis.length;i++){
                imageLis[i].style.webkitTransform = "translateX(" +windowWidth+ "px)";
                }
                imageLis[idx].style.transition = "none";
                imageLis[prev].style.transition = "none";
                imageLis[next].style.transition = "none"; 

                // 新的位置
                imageLis[idx].style.webkitTransform = "translateX(0)";
                imageLis[prev].style.webkitTransform = "translateX(" + -windowWidth+ "px)";
                imageLis[next].style.webkitTransform = "translateX(" + windowWidth+ "px)";
                
        }

        // 事件监听
        carousel.addEventListener("touchstart",touchstart,false);
        carousel.addEventListener("touchmove",touchmove,false);
        carousel.addEventListener("touchend",touchend,false);
        // 手指偏移量
        var deltaX;
        // 手指开始触碰时的位置
        var startX;

        // 时间戳
        var startTime;
        // clearInterval(timer);
        var timer = setInterval(showNext,2000)


        // 触摸开始
        function touchstart(event){
            event.preventDefault();
            // 超过一根手指不起效
            if(event.touches.length>1) return;

            // 清除定时器
            clearInterval(timer);
            // 记录偏移量
            deltaX = event.touches[0].clientX;

            // 记录手指位置
            startX = event.touches[0].clientX;

            imageLis[prev].style.transition = "none";
            imageLis[idx].style.transition = "none";
            imageLis[next].style.transition = "none";
            
            // 就绪，其实没必要，防止bug
            imageLis[idx].style.webkitTransform = "translateX(0)";
            imageLis[prev].style.webkitTransform = "translateX(" + -windowWidth+ "px)";
            imageLis[next].style.webkitTransform = "translateX(" + windowWidth + "px)";

            // 时间戳
            startTime = new Date();
        }

        // 手指移动
        function touchmove(event){
            event.preventDefault();
            if(event.touches.length>1) return;
            // clearInterval(timer);
            
            var clientX = event.touches[0].clientX;

            imageLis[prev].style.webkitTransform = "translateX("+ (-windowWidth+clientX-deltaX) +"px)";
            imageLis[idx].style.webkitTransform = "translateX("+ (clientX-deltaX) +"px)";
            imageLis[next].style.webkitTransform = "translateX("+ (windowWidth+clientX-deltaX) +"px)";
            
        }

        // 触摸结束
        function touchend(event){
            event.preventDefault();
            // clearInterval(timer);

            var distance = event.changedTouches[0].clientX - startX;

            var time = new Date() - startTime;
            
            if(distance >= windowWidth/2 || (distance>=30 &&time<=300)){
                showPrev();
            }else if((distance <= -windowWidth/2 || (distance<=-30 &&time<=300) )){
                showNext();
            }else{
                imageLis[prev].style.transition = "none";
                imageLis[idx].style.transition = "none";
                imageLis[next].style.transition = "none";
                
                imageLis[idx].style.webkitTransform = "translateX(0)";
                imageLis[prev].style.webkitTransform = "translateX(" + -windowWidth+ "px)";
                imageLis[next].style.webkitTransform = "translateX(" + windowWidth + "px)";
            }

            timer = setInterval(showNext,3000);
        }

     

        function showNext(){
            
            console.log("left");
            prev = idx;
            idx = next;

            next++;
            if(next>4) next=0;

            // imageLis[next].style.transition = "none";
            // imageLis[next].style.webkitTransform = "translateX("+windowWidth+"px)";

            imageLis[prev].style.transition = "all 0.3s ease 0s";
            imageLis[idx].style.transition = "all 0.3s ease 0s";

            // 移动
            imageLis[prev].style.webkitTransform = "translateX("+ -windowWidth+"px)";
            imageLis[idx].style.webkitTransform = "translateX(0)";
            
            cir();
        }
    


        function showPrev(){

            console.log("right");

            next = idx;
            idx = prev;

            prev--;
            if(prev<0) prev =4;

            // imageLis[next].style.transition = "none";
            // imageLis[next].style.webkitTransform = "translateX("+windowWidth+")";

            imageLis[idx].style.transition = "all 0.3s ease 0s";
            imageLis[next].style.transition = "all 0.3s ease 0s";

            // 移动
            imageLis[idx].style.webkitTransform = "translateX(0)";
            imageLis[next].style.webkitTransform = "translateX("+ windowWidth+"px)";
            
            cir();
        }


        function cir(){
            for(var i=0;i<olLis.length;i++){
                olLis[i].className="";
            }
            olLis[idx].className ="cur";
        }

        for(var i=0;i<olLis.length;i++){
            // var j = i;
            (function(i){
                olLis[i].onclick = function(){
                idx = i;
                // console.log(i);
                cir();
                // showNext();
            }})(i);
            }
    </script>
</body>
</html>